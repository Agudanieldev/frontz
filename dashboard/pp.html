<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profile Picture Upload</title>
    <!-- Include Firebase SDK scripts -->
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-storage.js"></script>
</head>
<body>
    <input type="file" accept="image/*" id="uploader">
    <button onclick="" id="fileButton">Upload Picture</button>

    <script type="module">
        // Initialize Firebase with your project config
        const firebaseConfig = {
        apiKey: "AIzaSyAVYnmzJvPlFWOjXiJDFChXZ8zAzQp1Ufw",
        authDomain: "oceandwell-01.firebaseapp.com",
        projectId: "oceandwell-01",
        storageBucket: "oceandwell-01.appspot.com",
        messagingSenderId: "288421578797",
        appId: "1:288421578797:web:5c1a7abf0b7e133b5190a4",
        measurementId: "G-LFHVNGR715"
        };

        firebase.initializeApp(firebaseConfig);
</script>
    <script>
        //Upload Profile Picture 
        //Altered code from: Firebase Youtube Channel. 

      //Get Elements
      var uploader = document.getElementById('uploader');
      var fileButton = document.getElementById('fileButton');

      //Listen for file 
      fileButton.addEventListener('change', function(e){

         //Get File
         var file = e.target.files[0];


         //Create a Storage Ref
         var storageRef = firebase.storage().ref('profilePictures/' + file.name);

         //Upload file
         var task = storageRef.put(file);

         var user = firebase.auth().currentUser;        

         //Update Progress Bar 
         task.on('state_changed', 

         function progress(snapshot){
            var percentage = (snapshot.bytesTransferred / snapshot.totalBytes) *100;
            uploader.value = percentage;

            //if percentage = 100
            //$(".overlay").hide();         
         },

         function error(err){

         },

         function complete(){

         }

       );           
    });


//Display Profile Picture   

function showUserDetails(){

   var user = firebase.auth().currentUser;
   var photoUrl;

   if (user != null) {
    //   name = user.displayName;
      photoUrl = user.photoURL;

      document.getElementById('dp').innerHTML=photoURL;
    //   document.getElementById('username').innerHTML=name;  
}}
    </script>
</body>
</html>
